<!DOCTYPE html>

<html lang="zh-cn">

<head>
    <meta charset="utf-8">
    <title>01 HtmlTest</title>
    <meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
</head>

<body>
    <script src="../dist/XType.js"></script>
    <script>
        // 自定义控件
        function Div(options = {}) {
            XType.Control.call(this, options);
        }

        Div.prototype = Object.create(XType.Control.prototype);
        Div.prototype.constructor = Div;

        Div.prototype.render = function () {
            // 通过createElement或createElementNS创建dom或svg
            this.dom = document.createElement('div');
            this.parent.appendChild(this.dom);

            // 属性，通过setAttribute给节点赋值
            if (this.attr) {
                Object.keys(this.attr).forEach(n => {
                    this.dom.setAttribute(n, this.attr[n]);
                });
            }

            // class属性
            if (this.cls) {
                this.dom.className = this.cls;
            }

            // 数据，直接赋值给dom
            if (this.data) {
                Object.assign(this.dom, this.data);
            }

            // 样式，赋值给dom.style
            if (this.style) {
                Object.assign(this.dom.style, this.style);
            }

            // 监听器，赋值给dom
            if (this.listeners) {
                Object.keys(this.listeners).forEach(n => {
                    this.dom['on' + n] = this.listeners[n];
                });
            }

            // 自定义数据，赋值给dom.userData
            if (this.userData) {
                this.dom.userData = {};
                Object.assign(this.dom.userData, this.userData);
            }

            // innerHTML属性
            if (this.html) {
                this.dom.innerHTML = this.html;
            }

            // 渲染子节点
            this.children.forEach(n => {
                var control = UI.create(n);
                control.parent = this.dom;
                control.render();
            });
        };

        // 注册xtype
        UI.addXType('div', Div);

        // 渲染自定义控件
        var control = UI.create({
            xtype: 'div',
            id: 'div1',
            parent: document.body,
            style: {
                width: '100px',
                height: '100px',
                backgroundColor: '#f00'
            },
            listeners: {
                click: () => {
                    alert('You clicked!');
                }
            }
        });
        control.render();
    </script>
</body>

</html>